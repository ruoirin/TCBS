import React, { useState } from 'react';
import { AreaChart, Area, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer, BarChart, Bar, Legend, PieChart, Pie, Cell, ScatterChart, Scatter, ZAxis, Label, LabelList } from 'recharts';
import { Rocket, Lightbulb, Banknote, Users, TrendingUp, Shield, BarChart2, PieChart as PieChartIcon, CheckCircle, XCircle } from 'lucide-react';
import { BarChart as BarChartIcon, BookOpen, ScrollText } from 'lucide-react';

const COLORS = ['#0088FE', '#00C49F', '#FFBB28', '#FF8042', '#AF19FF', '#F97316', '#22C55E'];

// Updated data from images
const dataFinancial = [
  { name: '2014', DoanhThu: 381, LoiNhuan: 181 },
  { name: '2015', DoanhThu: 621, LoiNhuan: 530 },
  { name: '2016', DoanhThu: 824, LoiNhuan: 604 },
  { name: '2017', DoanhThu: 1083, LoiNhuan: 917 },
  { name: '2018', DoanhThu: 1870, LoiNhuan: 1532 },
  { name: '2019', DoanhThu: 2172, LoiNhuan: 1819 },
  { name: '2020', DoanhThu: 3313, LoiNhuan: 2692 },
  { name: '2021', DoanhThu: 5205, LoiNhuan: 3810 },
  { name: '2022', DoanhThu: 5257, LoiNhuan: 3058 },
  { name: '2023', DoanhThu: 5276, LoiNhuan: 3028 },
  { name: '2024', DoanhThu: 7615, LoiNhuan: 4802 },
  { name: 'Q1/2025', DoanhThu: 2028, LoiNhuan: 1310 }
];

const dataMarketShare = [
  { name: 'VPS', value: 15.4 },
  { name: 'SSI', value: 10.9 },
  { name: 'TCBS', value: 7.5 },
  { name: 'Vietcap', value: 6.8 },
  { name: 'HSC', value: 6.7 },
  { name: 'VND', value: 6.4 },
  { name: 'Khác', value: 46.3 },
];

const dataFinancialTable = [
  { year: '2020', revenue: '3.313', profit: '2.692', roe: '40%', cir: '14.1%' },
  { year: '2021', revenue: '5.205', profit: '3.810', roe: '40%', cir: '17.5%' },
  { year: '2022', revenue: '5.257', profit: '3.058', roe: '29.4%', cir: '25.5%' },
  { year: '2023', revenue: '5.276', profit: '3.028', roe: '13%', cir: '19.3%' },
  { year: '2024', revenue: '7.615', profit: '4.802', roe: '15%', cir: '14.2%' },
  { year: 'Q1/2025', revenue: '2.028', profit: '1.310', roe: '15%', cir: '12.2%' },
];

// Calculate profit margin for the table data
const dataFinancialTableWithMargin = dataFinancialTable.map(row => {
  const revenue = parseFloat(row.revenue.replace('.', '')) * 1000000000;
  const profit = parseFloat(row.profit.replace('.', '')) * 1000000000;
  const profitMargin = revenue > 0 ? ((profit / revenue) * 100).toFixed(1) + '%' : 'N/A';
  return { ...row, profitMargin };
});

const dataCompetitorTable = [
  { feature: 'Mô hình kinh doanh trọng tâm', tcbs: 'Wealthtech toàn diện, số hóa đầu tư cá nhân', ssi: 'Cân bằng giữa bán lẻ & tổ chức, mạnh margin & tự doanh', vnd: 'Dịch vụ lấy khách hàng làm trung tâm, đầu tư công nghệ', hsc: 'Môi giới & ngân hàng đầu tư, mạnh phái sinh' },
  { feature: 'Lợi thế công nghệ', tcbs: 'Nền tảng độc quyền TCInvest, 99% tài khoản online', ssi: 'Nâng cấp hệ thống, SSI iBoard Pro', vnd: 'Đầu tư AI & hạ tầng, DAccount, D-Community', hsc: 'HSC ONE, dữ liệu thời gian thực, giao dịch đa tài sản' },
  { feature: 'Hỗ trợ từ công ty mẹ', tcbs: 'Techcombank (88.7% sở hữu), tài chính mạnh, mạng lưới khách hàng', ssi: 'Không có hỗ trợ ngân hàng mẹ trực tiếp', vnd: 'Không có hỗ trợ ngân hàng mẹ trực tiếp', hsc: 'Không có hỗ trợ ngân hàng mẹ trực tiếp' },
  { feature: 'Hiệu quả hoạt động', tcbs: 'CIR thấp, ROE cao, lợi nhuận/nhân viên vượt trội', ssi: 'ROE 10.1% (2023), cải thiện', vnd: 'Lợi nhuận Q1/2025 giảm YoY, thách thức về thị phần', hsc: 'Thiếu thông tin chi tiết so sánh' },
  { feature: 'Đa dạng hóa doanh thu', tcbs: 'Đa dạng hóa tốt (dịch vụ chứng khoán, ngân hàng đầu tư, kho bạc)', ssi: 'Phụ thuộc vào tự doanh và margin lending', vnd: 'Thiếu thông tin chi tiết so sánh', hsc: 'Thiếu thông tin chi tiết so sánh' },
];

const dataRevenueBySector = [
  { name: 'SSI', tuDoanh: 1128, choVay: 628, moiGioi: 311, tuVan: 0, khac: 0 },
  { name: 'TCBS', tuDoanh: 716, choVay: 732, moiGioi: 167, tuVan: 0, khac: 414 },
  { name: 'VND', tuDoanh: 813, choVay: 301, moiGioi: 135, tuVan: 0, khac: 0 },
  { name: 'VPS', tuDoanh: 344, choVay: 503, moiGioi: 579, tuVan: 0, khac: 0 },
  { name: 'VPBS', tuDoanh: 377, choVay: 262, moiGioi: 51, tuVan: 0, khac: 0 },
  { name: 'ACBS', tuDoanh: 475, choVay: 206, moiGioi: 67, tuVan: 0, khac: 0 },
  { name: 'HCM', tuDoanh: 249, choVay: 523, moiGioi: 164, tuVan: 0, khac: 0 },
  { name: 'MASC', tuDoanh: 84, choVay: 418, moiGioi: 105, tuVan: 0, khac: 0 },
  { name: 'VCI', tuDoanh: 421, choVay: 257, moiGioi: 149, tuVan: 0, khac: 0 },
  { name: 'MBS', tuDoanh: 236, choVay: 277, moiGioi: 133, tuVan: 0, khac: 0 },
];

const dataProfitAndMargin = [
  { name: 'TCBS', profit: 1310, margin: 64.6 },
  { name: 'SSI', profit: 1047, margin: 48.5 },
  { name: 'VPS', profit: 918, margin: 62.5 },
  { name: 'VND', profit: 478, margin: 36.0 },
  { name: 'VCI', profit: 355, margin: 41.7 },
  { name: 'VPBS', profit: 351, margin: 49.8 },
  { name: 'MBS', profit: 339, margin: 50.7 },
  { name: 'HCM', profit: 283, margin: 28.3 },
  { name: 'MASC', profit: 218, margin: 35.4 },
  { name: 'ACBS', profit: 182, margin: 24.1 },
];

const dataROA_ROE = [
  { name: 'TCBS', roe: 14, roa: 7.2, size: 56330 },
  { name: 'VPS', roe: 25, roa: 8.5, size: 70000 },
  { name: 'SSI', roe: 11.5, roa: 4.8, size: 90000 },
  { name: 'VND', roe: 8.5, roa: 3.5, size: 60000 },
  { name: 'HSC', roe: 12.0, roa: 4.5, size: 50000 },
  { name: 'VCI', roe: 9.5, roa: 4.8, size: 45000 },
  { name: 'MBS', roe: 13.0, roa: 4.5, size: 40000 },
  { name: 'HCM', roe: 10.5, roa: 4.0, size: 55000 },
  { name: 'ACBS', roe: 6.0, roa: 3.0, size: 30000 },
  { name: 'MASC', roe: 7.5, roa: 3.2, size: 25000 },
  { name: 'VPBS', roe: 5.5, roa: 3.0, size: 20000 },
];

// New data for market share of margin lending Q2/2025
const dataMarginLending = [
  { name: 'SSI', value: 33.1, percent: 10.9 },
  { name: 'TCBS', value: 30.4, percent: 10.0 },
  { name: 'VPS', value: 17.0, percent: 5.6 },
  { name: 'HSC', value: 20.3, percent: 6.7 }, // Dữ liệu từ Q1, không có Q2 cập nhật
  { name: 'VND', value: 11.1, percent: 3.7 }, // Dữ liệu từ Q1, không có Q2 cập nhật
  { name: 'MBS', value: 12.6, percent: 4.1 },
];

// Updated data for market share of corporate bond underwriting 2024
const dataBondUnderwriting = [
  { name: 'TCBS', value: 46 },
  { name: 'HDBS', value: 19 },
  { name: 'ABS', value: 5 },
  { name: 'MBS', value: 3 },
  { name: 'Khác', value: 27 },
];


const App = () => {
  const [activeSection, setActiveSection] = useState('overview');

  const scrollToSection = (id) => {
    const section = document.getElementById(id);
    if (section) {
      section.scrollIntoView({ behavior: 'smooth' });
      setActiveSection(id);
    }
  };

  return (
    <div className="min-h-screen bg-gray-100 font-sans text-gray-800">
      <header className="bg-white shadow-md p-4 sticky top-0 z-50">
        <div className="container mx-auto flex flex-col md:flex-row justify-between items-center flex-wrap gap-4">
          <div className="flex items-center space-x-2">
            <Rocket className="w-8 h-8 text-indigo-600" />
            <h1 className="text-xl md:text-2xl font-bold text-indigo-600">Báo cáo IPO TCBS</h1>
          </div>
          <nav className="flex flex-wrap justify-center md:justify-end space-x-2 md:space-x-4 text-sm md:text-base">
            <button onClick={() => scrollToSection('overview')} className={`px-3 py-2 rounded-lg transition-all duration-300 ${activeSection === 'overview' ? 'bg-indigo-600 text-white shadow-md' : 'text-gray-600 hover:bg-gray-200'}`}>Tổng Quan</button>
            <button onClick={() => scrollToSection('wealthtech')} className={`px-3 py-2 rounded-lg transition-all duration-300 ${activeSection === 'wealthtech' ? 'bg-indigo-600 text-white shadow-md' : 'text-gray-600 hover:bg-gray-200'}`}>Wealthtech</button>
            <button onClick={() => scrollToSection('financial')} className={`px-3 py-2 rounded-lg transition-all duration-300 ${activeSection === 'financial' ? 'bg-indigo-600 text-white shadow-md' : 'text-gray-600 hover:bg-gray-200'}`}>Tài Chính</button>
            <button onClick={() => scrollToSection('advantages')} className={`px-3 py-2 rounded-lg transition-all duration-300 ${activeSection === 'advantages' ? 'bg-indigo-600 text-white shadow-md' : 'text-gray-600 hover:bg-gray-200'}`}>Lợi Thế</button>
            <button onClick={() => scrollToSection('potential')} className={`px-3 py-2 rounded-lg transition-all duration-300 ${activeSection === 'potential' ? 'bg-indigo-600 text-white shadow-md' : 'text-gray-600 hover:bg-gray-200'}`}>Tiềm Năng</button>
          </nav>
        </div>
      </header>
      
      <main className="container mx-auto p-4 md:p-8">
        <SummarySection />
        <div id="overview">
          <OverviewSection />
        </div>
        <div id="wealthtech">
          <WealthtechSection />
          <GrowthSecretSection />
        </div>
        <div id="financial">
          <FinancialSection />
        </div>
        <div id="advantages">
          <AdvantagesSection />
        </div>
        <div id="potential">
          <PotentialSection />
        </div>
      </main>

      <footer className="bg-gray-800 text-white text-center p-4">
        <p className="text-sm">© 2025 Báo cáo Phân tích IPO TCBS. Dữ liệu mang tính tham khảo.</p>
      </footer>
    </div>
  );
};

const SectionWrapper = ({ id, title, icon: Icon, children }) => (
  <div id={id} className="bg-white rounded-xl shadow-lg p-6 md:p-8 mb-8 transition-all duration-300 hover:shadow-xl">
    <div className="flex items-center mb-6">
      <div className="p-3 bg-indigo-100 rounded-full text-indigo-600 mr-4">
        <Icon className="w-6 h-6" />
      </div>
      <h2 className="text-2xl md:text-3xl font-bold">{title}</h2>
    </div>
    <div className="space-y-4 text-gray-700 leading-relaxed text-sm md:text-base">
      {children}
    </div>
  </div>
);

const SummarySection = () => (
    <SectionWrapper id="summary" title="Tóm tắt Điều hành" icon={BookOpen}>
      <p>
      TCBS (Công ty Cổ phần Chứng khoán Kỹ thương), một công ty con của Techcombank, đang khẳng định vị thế là một trong những công ty chứng khoán hàng đầu tại Việt Nam, đặc biệt với vai trò tiên phong trong mô hình Wealthtech. Đợt chào bán cổ phiếu lần đầu ra công chúng (IPO) dự kiến diễn ra vào cuối năm 2025 hoặc đầu năm 2026.
      </p>
      <div className="bg-indigo-50 p-4 rounded-lg mt-4">
        <h4 className="font-semibold text-lg text-indigo-600 mb-2">Các điểm nhấn đầu tư chính:</h4>
        <ul className="list-disc list-inside space-y-2 pl-4">
            <li><strong>Tiên phong Wealthtech:</strong> TCBS đã xây dựng một hệ sinh thái đầu tư số hóa toàn diện.</li>
            <li><strong>Nền tảng công nghệ mạnh mẽ:</strong> Nền tảng TCInvest với tỷ lệ mở tài khoản trực tuyến gần 99%.</li>
            <li><strong>Hỗ trợ từ Techcombank:</strong> Hậu thuẫn từ ngân hàng mẹ với 88.7% sở hữu cung cấp nền tảng tài chính vững chắc.</li>
            <li><strong>Hiệu quả hoạt động vượt trội:</strong> Tỷ lệ chi phí trên thu nhập (CIR) thấp và lợi nhuận trên mỗi nhân viên cao.</li>
            <li><strong>Tiềm năng tăng trưởng:</strong> Thị trường Wealthtech tại Việt Nam đang ở giai đoạn sơ khai nhưng sở hữu tiềm năng phát triển to lớn.</li>
        </ul>
      </div>
    </SectionWrapper>
);

const OverviewSection = () => (
  <SectionWrapper id="overview" title="Tổng quan về IPO của TCBS và Lộ trình" icon={Rocket}>
    <p>
      Đợt IPO của TCBS được kỳ vọng sẽ là một trong những thương vụ đáng chú ý nhất trên thị trường tài chính Việt Nam. Công ty dự kiến huy động tổng cộng 10.817,82 tỷ VND thông qua việc phát hành 231.15 triệu cổ phiếu, với giá chào bán <strong>46.800 VND/cổ phiếu</strong>.
    </p>
    <div className="bg-indigo-50 p-4 rounded-lg mt-4">
        <h4 className="font-semibold text-lg text-indigo-600 mb-2">Kế hoạch sử dụng vốn:</h4>
        <ul className="list-disc list-inside space-y-2 pl-4">
            <li><strong>70% vốn (7.572 tỷ VND):</strong> Dùng cho hoạt động tự doanh chứng khoán.</li>
            <li><strong>30% còn lại (3.245 tỷ VND):</strong> Dùng cho hoạt động môi giới và cấp margin.</li>
        </ul>
    </div>
    <h3 className="font-semibold text-lg md:text-xl text-indigo-600 mt-6">Lộ trình IPO dự kiến</h3>
    <ul className="list-disc list-inside space-y-2 pl-4">
      <li>Mở đăng ký IPO trong tháng 09/2025.</li>
      <li>Niêm yết & Giao dịch trong Quý 4/2025.</li>
    </ul>
  </SectionWrapper>
);

const WealthtechSection = () => (
  <SectionWrapper id="wealthtech" title="Mô hình Wealthtech và cơ hội tại Việt Nam" icon={Lightbulb}>
    <p>
      Wealthtech kết hợp công nghệ và dịch vụ quản lý tài sản để cung cấp các giải pháp đầu tư tự động, cá nhân hóa. TCBS là một trong những công ty tiên phong áp dụng mô hình này tại Việt Nam.
    </p>
    <h3 className="font-semibold text-lg md:text-xl text-indigo-600 mt-6">Cơ hội phát triển Wealthtech tại Việt Nam</h3>
    <ul className="list-disc list-inside space-y-2 pl-4">
      <li>
        <strong>Dân số trẻ và am hiểu công nghệ:</strong> Tỷ lệ dân số trẻ cao, với hơn 70% dân số sử dụng Internet.
      </li>
      <li>
        <strong>Tăng trưởng thu nhập:</strong> Tầng lớp trung lưu và giàu có đang tăng nhanh, nhu cầu quản lý tài sản chuyên nghiệp ngày càng lớn.
      </li>
      <li>
        <strong>Thị trường còn sơ khai:</strong> Các dịch vụ Wealthtech vẫn còn mới mẻ, mang lại cơ hội lớn cho các doanh nghiệp tiên phong.
      </li>
    </ul>
    <div className="bg-indigo-50 p-4 rounded-lg mt-4">
      <p className="font-semibold text-indigo-600 flex items-center">
        <Users className="mr-2" />Chiến lược của TCBS:
      </p>
      <p className="ml-6">
        TCBS tận dụng dữ liệu lớn và AI để phân tích hành vi người dùng, từ đó đưa ra các sản phẩm đầu tư phù hợp, tối ưu hóa trải nghiệm khách hàng và giảm chi phí.
      </p>
    </div>
  </SectionWrapper>
);

const GrowthSecretSection = () => (
  <SectionWrapper id="growth-secret" title="Bí quyết tăng trưởng - Mô hình khác biệt" icon={TrendingUp}>
    <p>Xây dựng thành công mô hình kinh doanh wealthTech khác biệt dựa trên 3 trụ cột:</p>
    <div className="grid md:grid-cols-3 gap-6 mt-6 text-center">
      <div className="flex flex-col items-center p-4 bg-gray-50 rounded-lg shadow-sm">
        <div className="p-3 bg-blue-100 rounded-full text-blue-600 mb-4">
          <BookOpen className="w-6 h-6" />
        </div>
        <h4 className="font-semibold text-lg text-blue-600">Sản phẩm khác biệt</h4>
        <ul className="list-disc list-inside text-sm text-gray-700 text-left mt-2 space-y-1">
          <li>Nền tảng Siêu thị đầu tư (Super Mall of Wealth) cung cấp các giải pháp tài chính toàn diện và tiên phong.</li>
          <li>Xây dựng các dịch vụ và sản phẩm đa dạng đáp ứng mọi phân khúc khách hàng.</li>
        </ul>
      </div>
      <div className="flex flex-col items-center p-4 bg-gray-50 rounded-lg shadow-sm">
        <div className="p-3 bg-green-100 rounded-full text-green-600 mb-4">
          <Banknote className="w-6 h-6" />
        </div>
        <h4 className="font-semibold text-lg text-green-600">Mô hình tiếp cận Phygital</h4>
        <ul className="list-disc list-inside text-sm text-gray-700 text-left mt-2 space-y-1">
          <li>Tận dụng hệ sinh thái Techcombank: RM, đại lý bảo hiểm, môi giới BDS giới thiệu khách hàng.</li>
          <li>Hệ thống giao dịch 100% online qua ứng dụng TCInvest.</li>
        </ul>
      </div>
      <div className="flex flex-col items-center p-4 bg-gray-50 rounded-lg shadow-sm">
        <div className="p-3 bg-red-100 rounded-full text-red-600 mb-4">
          <ScrollText className="w-6 h-6" />
        </div>
        <h4 className="font-semibold text-lg text-red-600">Nền tảng vượt trội</h4>
        <ul className="list-disc list-inside text-sm text-gray-700 text-left mt-2 space-y-1">
          <li>Sở hữu và làm chủ dữ liệu và trí tuệ nhân tạo AI.</li>
          <li>Sở hữu hàng trăm nhân sự là Chuyên gia công nghệ tài chính (Wealth Technologist).</li>
          <li>Sở hữu và làm chủ công nghệ và nền tảng cốt lõi.</li>
        </ul>
      </div>
    </div>
  </SectionWrapper>
);


const FinancialSection = () => {
  const [chartType, setChartType] = useState('area');
  
  return (
    <SectionWrapper id="financial" title="Báo cáo phân tích tài chính của TCBS" icon={Banknote}>
      <p>
        TCBS liên tục ghi nhận kết quả kinh doanh tăng trưởng ấn tượng, khẳng định vị thế dẫn đầu trong ngành chứng khoán về hiệu quả hoạt động.
      </p>
      
      <div className="flex justify-center md:justify-end space-x-2 mb-4">
        <button onClick={() => setChartType('area')} className={`p-2 rounded-lg transition-all duration-300 ${chartType === 'area' ? 'bg-indigo-600 text-white' : 'bg-gray-200 text-gray-600'}`}>
          <BarChart2 className="w-5 h-5" />
        </button>
        <button onClick={() => setChartType('bar')} className={`p-2 rounded-lg transition-all duration-300 ${chartType === 'bar' ? 'bg-indigo-600 text-white' : 'bg-gray-200 text-gray-600'}`}>
          <BarChartIcon className="w-5 h-5" />
        </button>
      </div>
      
      <div className="w-full h-80 bg-gray-50 rounded-lg p-2">
        <ResponsiveContainer width="100%" height="100%">
          {chartType === 'area' ? (
            <AreaChart data={dataFinancial} margin={{ top: 10, right: 30, left: 0, bottom: 0 }}>
              <CartesianGrid strokeDasharray="3 3" />
              <XAxis dataKey="name" />
              <YAxis />
              <Tooltip />
              <Legend />
              <Area type="monotone" dataKey="DoanhThu" stroke="#8884d8" fill="#8884d8" name="Doanh thu (tỷ VNĐ)" />
              <Area type="monotone" dataKey="LoiNhuan" stroke="#82ca9d" fill="#82ca9d" name="Lợi nhuận trước thuế (tỷ VNĐ)" />
            </AreaChart>
          ) : (
            <BarChart data={dataFinancial} margin={{ top: 5, right: 30, left: 20, bottom: 5 }}>
              <CartesianGrid strokeDasharray="3 3" />
              <XAxis dataKey="name" />
              <YAxis />
              <Tooltip />
              <Legend />
              <Bar dataKey="DoanhThu" fill="#8884d8" name="Doanh thu (tỷ VNĐ)" />
              <Bar dataKey="LoiNhuan" fill="#82ca9d" name="Lợi nhuận trước thuế (tỷ VNĐ)" />
            </BarChart>
          )}
        </ResponsiveContainer>
      </div>

      <h3 className="font-semibold text-lg md:text-xl text-indigo-600 mt-8">Các Chỉ số Hiệu quả Tài chính Chính</h3>
      <p className="mt-2">Bảng dưới đây tổng hợp một số chỉ số tài chính của TCBS, dựa trên các dữ liệu có sẵn.</p>
      <div className="overflow-x-auto rounded-lg shadow-md mt-4">
        <table className="min-w-full divide-y divide-gray-200">
          <thead className="bg-gray-50">
            <tr>
              <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Năm/Quý</th>
              <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Doanh thu (tỷ VNĐ)</th>
              <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Lợi nhuận trước thuế (tỷ VNĐ)</th>
              <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ROE (%)</th>
              <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Biên lợi nhuận trước thuế (%)</th>
              <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">CIR (%)</th>
            </tr>
          </thead>
          <tbody className="bg-white divide-y divide-gray-200">
            {dataFinancialTableWithMargin.map((row, index) => (
              <tr key={index}>
                <td className="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">{row.year}</td>
                <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{row.revenue}</td>
                <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{row.profit}</td>
                <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{row.roe}</td>
                <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{row.profitMargin}</td>
                <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{row.cir}</td>
              </tr>
            ))}
          </tbody>
        </table>
      </div>
      
      <h3 className="font-semibold text-lg md:text-xl text-indigo-600 mt-8">Thuyết minh Các chỉ số</h3>
      <p className="mt-2">
        <strong>ROE (Return on Equity - Tỷ suất sinh lời trên vốn chủ sở hữu):</strong> ROE là chỉ số đo lường mức độ hiệu quả sử dụng vốn của cổ đông để tạo ra lợi nhuận. Chỉ số ROE cao cho thấy công ty đang sử dụng vốn chủ sở hữu một cách hiệu quả để tạo ra lợi nhuận ròng.
      </p>
      <p className="mt-2">
        <strong>CIR (Cost-to-Income Ratio - Tỷ lệ chi phí trên thu nhập):</strong> CIR là chỉ số đánh giá khả năng kiểm soát chi phí của một công ty. Chỉ số CIR thấp cho thấy công ty đang hoạt động hiệu quả, với chi phí được kiểm soát tốt so với doanh thu.
      </p>
      <p className="mt-2">
        <strong>Biên lợi nhuận trước thuế:</strong> Là tỷ lệ phần trăm giữa lợi nhuận trước thuế và doanh thu. Chỉ số này cho biết cứ 100 đồng doanh thu, công ty tạo ra bao nhiêu đồng lợi nhuận trước thuế. Biên lợi nhuận cao cho thấy công ty có khả năng quản lý chi phí tốt và hoạt động kinh doanh hiệu quả.
      </p>
      
      <h3 className="font-semibold text-lg md:text-xl text-indigo-600 mt-8">Phân tích So sánh Hiệu quả Tài chính Ngành Chứng khoán Q1/2025</h3>
      
      <div className="mt-6 bg-gray-50 rounded-lg p-4">
        <h4 className="font-semibold text-lg text-center text-gray-700 mb-4">Đồ thị 31: Doanh thu theo lĩnh vực kinh doanh của 10 CTCK có tổng tài sản lớn nhất Q1/2025 (tỷ đồng)</h4>
        <ResponsiveContainer width="100%" height={300}>
          <BarChart data={dataRevenueBySector} margin={{ top: 20, right: 30, left: 20, bottom: 5 }}>
            <CartesianGrid strokeDasharray="3 3" />
            <XAxis dataKey="name" />
            <YAxis />
            <Tooltip />
            <Legend />
            <Bar dataKey="tuDoanh" stackId="a" fill="#D32F2F" name="Doanh thu tự doanh" />
            <Bar dataKey="choVay" stackId="a" fill="#757575" name="Thu nhập từ cho vay" />
            <Bar dataKey="moiGioi" stackId="a" fill="#90A4AE" name="Doanh thu môi giới" />
            <Bar dataKey="tuVan" stackId="a" fill="#BDBDBD" name="Doanh thu tư vấn" />
            <Bar dataKey="khac" stackId="a" fill="#E0E0E0" name="Doanh thu khác" />
          </BarChart>
        </ResponsiveContainer>
      </div>

      <div className="mt-6 bg-gray-50 rounded-lg p-4">
        <h4 className="font-semibold text-lg text-center text-gray-700 mb-4">Đồ thị 32: Lợi nhuận trước thuế và biên lợi nhuận trước thuế của 10 CTCK có tổng tài sản lớn nhất Q1/2025</h4>
        <ResponsiveContainer width="100%" height={300}>
          <BarChart data={dataProfitAndMargin} margin={{ top: 20, right: 30, left: 20, bottom: 5 }}>
            <CartesianGrid strokeDasharray="3 3" />
            <XAxis dataKey="name" />
            <YAxis yAxisId="left" orientation="left" stroke="#D32F2F" />
            <YAxis yAxisId="right" orientation="right" stroke="#42A5F5" />
            <Tooltip />
            <Legend />
            <Bar yAxisId="left" dataKey="profit" fill="#D32F2F" name="Lợi nhuận trước thuế (tỷ đồng)" />
            <Area yAxisId="right" type="monotone" dataKey="margin" stroke="#42A5F5" fill="#42A5F5" name="Biên LNTT (%)" />
          </BarChart>
        </ResponsiveContainer>
      </div>
      
      <div className="mt-6 bg-gray-50 rounded-lg p-4">
        <h4 className="font-semibold text-lg text-center text-gray-700 mb-4">Đồ thị 33: ROA & ROE của 10 CTCK có tổng tài sản lớn nhất Q1/2025</h4>
        <ResponsiveContainer width="100%" height={300}>
          <ScatterChart
            margin={{
              top: 20,
              right: 20,
              bottom: 20,
              left: 20,
            }}
          >
            <CartesianGrid />
            <XAxis type="number" dataKey="roe" name="ROE" unit="%" domain={[0, 30]}/>
            <YAxis type="number" dataKey="roa" name="ROA" unit="%" domain={[0, 10]}/>
            <ZAxis type="number" dataKey="size" range={[100, 1000]} name="Tổng tài sản (tỷ đồng)" />
            <Tooltip cursor={{ strokeDasharray: '3 3' }} />
            <Legend />
            <Scatter name="ROA & ROE" data={dataROA_ROE} fill="#8884d8" >
              {dataROA_ROE.map((entry, index) => (
                <Cell key={`cell-${index}`} fill={COLORS[index % COLORS.length]} />
              ))}
              <LabelList dataKey="name" position="inside" fill="#fff" style={{ fontSize: '12px' }} />
            </Scatter>
          </ScatterChart>
        </ResponsiveContainer>
        <p className="text-sm text-gray-500 mt-2">
          Ghi chú: Độ lớn của vòng tròn thể hiện độ lớn của tổng tài sản
        </p>
      </div>
    </SectionWrapper>
  );
};

const AdvantagesSection = () => (
  <SectionWrapper id="advantages" title="Lợi thế của TCBS và so sánh với đối thủ" icon={Shield}>
    <p>
      TCBS đã xây dựng những lợi thế cạnh tranh độc đáo, giúp công ty nổi bật trong ngành chứng khoán Việt Nam, đặc biệt là so với các đối thủ như SSI, VNDirect, HSC.
    </p>

    <h3 className="font-semibold text-lg md:text-xl text-indigo-600 mt-6">Thị phần môi giới (Q2/2025)</h3>
    <div className="w-full h-80 bg-gray-50 rounded-lg p-2">
      <ResponsiveContainer width="100%" height="100%">
        <PieChart>
          <Pie data={dataMarketShare} cx="50%" cy="50%" labelLine={false} outerRadius={80} fill="#8884d8" dataKey="value" label={({ name, percent }) => `${name}: ${(percent * 100).toFixed(0)}%`}>
            {dataMarketShare.map((entry, index) => (
              <Cell key={`cell-${index}`} fill={COLORS[index % COLORS.length]} />
            ))}
          </Pie>
          <Tooltip />
          <Legend />
        </PieChart>
      </ResponsiveContainer>
    </div>

    <h3 className="font-semibold text-lg md:text-xl text-indigo-600 mt-8">Thị phần dư nợ cho vay ký quỹ (Margin) Q2/2025</h3>
    <p className="mt-2">Dữ liệu cho thấy SSI và TCBS đang dẫn đầu về dư nợ margin, bỏ xa các đối thủ còn lại, phản ánh tiềm lực tài chính mạnh mẽ. Tổng dư nợ margin toàn thị trường đạt hơn 304 nghìn tỷ VNĐ trong Q2/2025.</p>
    <div className="w-full h-80 bg-gray-50 rounded-lg p-2 mt-4">
      <ResponsiveContainer width="100%" height="100%">
        <BarChart
          data={dataMarginLending}
          margin={{
            top: 20,
            right: 30,
            left: 20,
            bottom: 5,
          }}
        >
          <CartesianGrid strokeDasharray="3 3" />
          <XAxis dataKey="name" />
          <YAxis unit=" nghìn tỷ VNĐ" />
          <Tooltip />
          <Legend />
          <Bar dataKey="value" fill="#8884d8" name="Dư nợ Margin">
            <LabelList dataKey="percent" position="top" formatter={(value) => `${value}%`} />
          </Bar>
        </BarChart>
      </ResponsiveContainer>
    </div>

    <h3 className="font-semibold text-lg md:text-xl text-indigo-600 mt-8">Thị phần tư vấn phát hành TPDN 2024</h3>
    <p className="mt-2">
      Biểu đồ dưới đây cho thấy thị phần tư vấn phát hành trái phiếu doanh nghiệp (TPDN) năm 2024 (không tính nhóm Ngân hàng). TCBS nổi bật với thị phần vượt trội so với các đối thủ. Tổng giá trị phát hành trong năm 2024 là 159 nghìn tỷ đồng.
    </p>
    <div className="w-full h-80 bg-gray-50 rounded-lg p-2 mt-4">
      <ResponsiveContainer width="100%" height="100%">
        <PieChart>
          <Pie
            data={dataBondUnderwriting}
            cx="50%"
            cy="50%"
            labelLine={false}
            outerRadius={100}
            innerRadius={60}
            fill="#8884d8"
            dataKey="value"
            label={({ name, percent }) => `${name}: ${(percent * 100).toFixed(0)}%`}
          >
            {dataBondUnderwriting.map((entry, index) => (
              <Cell key={`cell-${index}`} fill={COLORS[index % COLORS.length]} />
            ))}
          </Pie>
          <Tooltip />
          <Legend />
        </PieChart>
      </ResponsiveContainer>
    </div>

    <h3 className="font-semibold text-lg md:text-xl text-indigo-600 mt-8">So sánh Đặc điểm Chính</h3>
    <div className="overflow-x-auto rounded-lg shadow-md mt-4">
      <table className="min-w-full divide-y divide-gray-200">
        <thead className="bg-gray-50">
          <tr>
            <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Đặc điểm</th>
            <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">TCBS</th>
            <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">SSI</th>
            <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">VNDirect</th>
            <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">HSC</th>
          </tr>
        </thead>
        <tbody className="bg-white divide-y divide-gray-200">
          {dataCompetitorTable.map((row, index) => (
            <tr key={index}>
              <td className="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">{row.feature}</td>
              <td className="px-6 py-4 text-sm text-gray-500">{row.tcbs}</td>
              <td className="px-6 py-4 text-sm text-gray-500">{row.ssi}</td>
              <td className="px-6 py-4 text-sm text-gray-500">{row.vnd}</td>
              <td className="px-6 py-4 text-sm text-gray-500">{row.hsc}</td>
            </tr>
          ))}
        </tbody>
      </table>
    </div>
  </SectionWrapper>
);

const PotentialSection = () => (
  <SectionWrapper id="potential" title="Đánh giá tiềm năng đầu tư vào TCBS (2025)" icon={TrendingUp}>
    <h3 className="font-semibold text-lg md:text-xl text-indigo-600">Tại sao nên đầu tư?</h3>
    <ul className="list-disc list-inside space-y-2 pl-4">
      <li>
        <strong>Bối cảnh kinh tế vĩ mô thuận lợi:</strong> Việt Nam dự kiến tăng trưởng GDP mạnh mẽ, thị trường chứng khoán được kỳ vọng nâng hạng và hệ thống KRX đi vào hoạt động.
      </li>
      <li>
        <strong>Vị thế dẫn đầu Wealthtech:</strong> TCBS có lợi thế người đi đầu và nền tảng công nghệ độc quyền, giúp công ty duy trì chu kỳ đổi mới.
      </li>
      <li>
        <strong>Hiệu quả tài chính vượt trội:</strong> Các chỉ số hiệu quả hoạt động cao và khả năng kiểm soát chi phí tốt.
      </li>
    </ul>

    <h3 className="font-semibold text-lg md:text-xl text-indigo-600 mt-6">Cơ hội và Rủi ro</h3>
    <div className="grid md:grid-cols-2 gap-6 mt-4">
      <div className="bg-emerald-50 p-4 rounded-lg shadow-sm">
        <h4 className="flex items-center font-bold text-emerald-700 text-lg mb-2">
          <CheckCircle className="mr-2" />Cơ hội
        </h4>
        <ul className="list-disc list-inside space-y-2 text-gray-700">
          <li>Tăng trưởng thị trường chứng khoán Việt Nam.</li>
          <li>Phát triển Wealthtech, gia tăng tầng lớp trung lưu.</li>
          <li>Sự hỗ trợ và tệp khách hàng từ Techcombank.</li>
        </ul>
      </div>
      <div className="bg-red-50 p-4 rounded-lg shadow-sm">
        <h4 className="flex items-center font-bold text-red-700 text-lg mb-2">
          <XCircle className="mr-2" />Rủi ro
        </h4>
        <ul className="list-disc list-inside space-y-2 text-gray-700">
          <li>Biến động thị trường chung và rủi ro vĩ mô.</li>
          <li>Cạnh tranh gay gắt từ các đối thủ truyền thống.</li>
          <li>Rủi ro liên quan đến việc định giá IPO.</li>
        </ul>
      </div>
    </div>
  </SectionWrapper>
);

export default App;
